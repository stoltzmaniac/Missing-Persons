{
    "collab_server" : "",
    "contents" : "library(lubridate)\nlibrary(dplyr)\nlibrary(ggmap)\n\n##### Data From: https://data.world/jamesgray/missing-children-in-the-us\n# missing.persons = read.csv(\"https://query.data.world/s/57mcfy9olvjsi3imujwdh9xoq\",header=T)\n# missing.persons$location = paste(missing.persons$missingfromcity,\", \",\n#                                  missing.persons$missingfromstate,\", \",\n#                                  missing.persons$missingfromcountry,\n#                                  sep='')\n#####\n\n##### Grabbed all places, geo coded, wrote to a csv to save time\n#places = unique(missing.persons$location)\n#places.latlon = geocode(places)\n#places.df = cbind(places,places.latlon)\n#write.csv(places.df,'places_latlon.csv',row.names=FALSE)\n#places = read.csv('places_latlon.csv')\n######\n\n###### Merged data and created new file\n# df = merge(missing.persons,places,by.x='location',by.y='places')\n# write.csv(df,'missing_persons_data_joined.csv',row.names=FALSE)\n######\n\ndf = read.csv('missing_persons_data_joined.csv')\ndf$age = floor(as.numeric((today() - as.Date(df$birthdate))/365))\ndf$birthMonth = month(as.Date(df$birthdate),label=TRUE)\ndf$birthYear = year(as.Date(df$birthdate))\n\ndf$ageGoneMissingFrom = floor(as.numeric((as.Date(df$missingfromdate) - as.Date(df$birthdate))/365))\ndf$ageGoneMissingReported = floor(as.numeric((as.Date(df$missingreporteddate) - as.Date(df$birthdate))/365))\n\ndf$missingToReportedYears = floor(as.numeric((as.Date(df$missingreporteddate) - as.Date(df$missingfromdate))/365))\ndf$currentYearsMissing = floor(as.numeric((today() - as.Date(df$missingfromdate))/365))\n\ndf$missingReportedHour = hour(df$missingreporteddate)\ndf$missingReportedDayOfWeek = wday(df$missingreporteddate,label=TRUE) \ndf$missingReportedMonth = month(df$missingreporteddate,label=TRUE)\ndf$missingReportedYear = year(df$missingreporteddate) \n\ndf$missingFromHour = hour(df$missingfromdate)\ndf$missingFromDayOfWeek = wday(df$missingfromdate,label=TRUE)\ndf$missingFromMonth = month(df$missingfromdate,label=TRUE)\ndf$missingFromYear = year(df$missingfromdate) \n\ndf$childName = paste(df$childfirstname, df$childlastname)\n\ndf$ageDecade = \"0-9\"\ndf$ageDecade[df$age >= 10] = \"10-19\"\ndf$ageDecade[df$age >= 20] = \"20-29\"\ndf$ageDecade[df$age >= 30] = \"30-39\"\ndf$ageDecade[df$age >= 40] = \"40-49\"\ndf$ageDecade[df$age >= 50] = \"50-59\"\ndf$ageDecade = as.factor(df$ageDecade)\n\ndf$ageGoneMissingFromDecade = \"0-9\"\ndf$ageGoneMissingFromDecade[df$ageGoneMissingFrom >= 10] = \"10-19\"\ndf$ageGoneMissingFromDecade[df$ageGoneMissingFrom >= 20] = \"20-29\"\ndf$ageGoneMissingFromDecade[df$ageGoneMissingFrom >= 30] = \"30-39\"\ndf$ageGoneMissingFromDecade[df$ageGoneMissingFrom >= 40] = \"40-49\"\ndf$ageGoneMissingFromDecade[df$ageGoneMissingFrom >= 50] = \"50-59\"\ndf$ageGoneMissingFromDecade = as.factor(df$ageGoneMissingFromDecade)\n\ndf$ageGoneMissingReportedDecade = \"0-9\"\ndf$ageGoneMissingReportedDecade[df$ageGoneMissingReported >= 10] = \"10-19\"\ndf$ageGoneMissingReportedDecade[df$ageGoneMissingReported >= 20] = \"20-29\"\ndf$ageGoneMissingReportedDecade[df$ageGoneMissingReported >= 30] = \"30-39\"\ndf$ageGoneMissingReportedDecade[df$ageGoneMissingReported >= 40] = \"40-49\"\ndf$ageGoneMissingReportedDecade[df$ageGoneMissingReported >= 50] = \"50-59\"\ndf$ageGoneMissingReportedDecade = as.factor(df$ageGoneMissingReportedDecade)\n\np = ggplot(df,aes(x=missingFromYear))\np + geom_line(stat='count')\np + geom_line(stat='count',aes(col=casetype))\n###Notice how casetype shows the massive spike in endangered runaway, gotta remove for analysis\n\n\n\ndf.backup = df\n\ner = df %>% filter(casetype == 'Endangered Runaway')\ndf = df %>% filter(casetype != 'Endangered Runaway')\n\n##summary(er$age) shows us that most are around 17 years old, but min is 2 and max is 63... kind of ridiculous\n\n#p = ggplot(df, aes(x=ageGoneMissingFrom,y=ageGoneMissingReported))\n#p + geom_point(aes(col=ageDecade),alpha=.5) + geom_abline(slope=1,col='red')\n\n#p = ggplot(df,aes(x=missingReportedYear))\n#p + geom_line(stat='count')\n\n\np = ggplot(df,aes(x=missingFromYear))\np + geom_line(stat='count')\np + geom_line(stat='count',aes(col=sex,fill=sex))\np + geom_area(position='fill',stat='count',aes(col=sex,fill=sex)) + geom_abline(intercept=0.5,slope=0,col='black',size=3)\n\np = ggplot(df %>% group_by(ageGoneMissingReportedDecade),aes(x=ageGoneMissingReportedDecade))\np + geom_bar(position='fill',stat='count',aes(col=sex,fill=sex))\np + geom_bar(stat='count',aes(col=sex,fill=sex))\n\np = ggplot(df %>% group_by(ageGoneMissingReportedDecade),aes(x=ageGoneMissingReportedDecade))\np + geom_bar(position='fill',stat='count',aes(col=sex,fill=sex))\n\np = ggplot(df,aes(x=birthYear))\np + geom_area(position='fill',stat='count',aes(col=sex,fill=sex))\n\np = ggplot(df,aes(x=birthYear))\np + geom_area(position='fill',stat='count',aes(col=haircolor,fill=haircolor))\n\np = ggplot(df,aes(x=ageGoneMissingFrom))\np + geom_area(stat='count',aes(col=haircolor,fill=haircolor))\np + geom_area(stat='count',aes(col=sex,fill=sex))\np + geom_area(position='fill',stat='count',aes(col=sex,fill=sex)) + geom_abline(intercept=0.5,slope=0,col='black',size=3)\np + geom_area(position='fill',stat='count',aes(col=eyecolor,fill=eyecolor))\np + geom_area(stat='count',aes(col=casetype,fill=casetype))\n\n\n\n\nlibrary(googleVis)\n\ntmp = df %>% \n  filter(missingfromcountry == 'United States') %>% \n  group_by(missingfromstate) %>%\n  summarise(meanAgeGoneMissingReported = round(mean(ageGoneMissingReported, na.rm=TRUE),0), \n            medianAgeGoneMissingReported = round(median(ageGoneMissingReported, na.rm=TRUE),0),\n            minAgeGoneMissingReported = round(min(ageGoneMissingReported, na.rm=TRUE),0),\n            maxAgeGoneMissingReported = round(max(ageGoneMissingReported, na.rm=TRUE),0))\n\np = gvisGeoChart(tmp,\"missingfromstate\",colorvar=\"medianAgeGoneMissingReported\",options=list(region=\"US\",\n                                                                     displayMode=\"regions\",\n                                                                     resolution=\"provinces\",\n                                                                     colors=\"['red','yellow','green']\",\n                                                                     width=1000, height=600))\n\nplot(p)\n\np = gvisGeoChart(tmp,\"missingfromstate\",colorvar=\"meanAgeGoneMissingReported\",options=list(region=\"US\",\n                                                                                             displayMode=\"regions\",\n                                                                                             resolution=\"provinces\",\n                                                                                             colors=\"['red','yellow','green']\",\n                                                                                             width=1000, height=600))\nplot(p)\n\np = gvisGeoChart(tmp,\"missingfromstate\",colorvar=\"minAgeGoneMissingReported\",options=list(region=\"US\",\n                                                                                           displayMode=\"regions\",\n                                                                                           resolution=\"provinces\",\n                                                                                           colors=\"['red','yellow','green']\",\n                                                                                           width=1000, height=600))\nplot(p)\n\np = gvisGeoChart(tmp,\"missingfromstate\",colorvar=\"maxAgeGoneMissingReported\",options=list(region=\"US\",\n                                                                                          displayMode=\"regions\",\n                                                                                          resolution=\"provinces\",\n                                                                                          colors=\"['red','yellow','green']\",\n                                                                                          width=1000, height=600))\nplot(p)\n##\n",
    "created" : 1491358059700.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3504260403",
    "id" : "75E013E2",
    "lastKnownWriteTime" : 1491514314,
    "last_content_update" : 1491514314938,
    "path" : "~/Documents/GitHub/Missing-Persons/workspace.R",
    "project_path" : "workspace.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}